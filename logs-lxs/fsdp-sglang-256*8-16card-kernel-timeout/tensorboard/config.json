{
    "cluster": {
        "num_nodes": 1,
        "component_placement": {
            "actor,rollout,reward": "all"
        }
    },
    "runner": {
        "task_type": "reasoning",
        "logger": {
            "log_path": "./logs/fsdp-sglang-256*8-16card",
            "project_name": "rlinf",
            "experiment_name": "fsdp-sglang-256*8-16card",
            "logger_backends": [
                "tensorboard"
            ]
        },
        "max_epochs": 5,
        "max_steps": -1,
        "val_check_interval": 1,
        "save_interval": 50,
        "seq_length": 28672,
        "enable_dynamic_batch_size": false,
        "max_tokens_per_mbs": 28672,
        "resume_dir": null,
        "experiment_name": "fsdp-sglang-256*8-16card",
        "output_dir": "./logs"
    },
    "algorithm": {
        "group_size": 8,
        "n_minibatches": 4,
        "training_batch_size_per_gpu": 1,
        "rollout_batch_size_per_gpu": null,
        "logprob_forward_micro_batch_size": 1,
        "val_rollout_batch_size_per_gpu": 4,
        "recompute_logprobs": true,
        "shuffle_rollout": false,
        "loss_type": "math_ppo_actor",
        "loss_agg_func": "token-mean",
        "kl_beta": 0.0,
        "kl_penalty_type": "low_var_kl",
        "ratio_clip_eps": 0.2,
        "entropy_bonus": 0.0,
        "calculate_entropy": false,
        "clip_ratio_c": null,
        "clip_ratio_low": null,
        "clip_ratio_high": null,
        "adv_type": "math_grpo",
        "normalize_advantages": true,
        "early_stop_imp_ratio": 5.0,
        "use_valid_token_scale": false,
        "sampling_params": {
            "use_greedy": false,
            "temperature": 1.0,
            "top_k": 1000000,
            "top_p": 1.0,
            "repetition_penalty": 1.0,
            "max_new_tokens": 27648,
            "min_new_tokens": 1
        },
        "max_num_gen_batches": 1
    },
    "rollout": {
        "group_name": "RolloutGroup",
        "gpu_memory_utilization": 0.55,
        "model_dir": "/home/weight/DeepSeek-R1-Distill-Qwen-1.5B-2layer/",
        "model_arch": "qwen2.5",
        "enforce_eager": false,
        "distributed_executor_backend": "mp",
        "disable_log_stats": false,
        "detokenize": false,
        "padding": null,
        "eos": null,
        "rollout_backend": "sglang",
        "sglang": {
            "attention_backend": "ascend",
            "decode_log_interval": 4096,
            "use_torch_compile": false,
            "torch_compile_max_bs": 128
        },
        "vllm": {
            "attention_backend": "FLASH_ATTN",
            "enable_chunked_prefill": true,
            "enable_prefix_caching": true,
            "enable_flash_infer_sampler": true,
            "max_num_batched_tokens": null,
            "torch_profiler_dir": null
        },
        "return_logprobs": false,
        "tensor_parallel_size": 1,
        "pipeline_parallel_size": 1,
        "validate_weight": false,
        "validate_save_dir": null,
        "print_outputs": false,
        "max_running_requests": 128,
        "cuda_graph_max_bs": 128
    },
    "data": {
        "type": "math",
        "dataset_name": "boba",
        "max_prompt_length": 1024,
        "filter_prompt_by_length": true,
        "rollout_batch_size": 256,
        "val_rollout_batch_size": null,
        "num_workers": 2,
        "shuffle": true,
        "validation_shuffle": true,
        "seed": 1234,
        "train_data_paths": [
            "/home/dataset/boba/AReaL-boba-106k.jsonl"
        ],
        "val_data_paths": [
            "/home/dataset/boba/AReaL-boba-106k.jsonl"
        ],
        "prompt_key": "prompt",
        "image_keys": [
            "image"
        ],
        "answer_key": "answer",
        "choice_key": "choices",
        "solution_key": null,
        "use_chat_template": true,
        "lazy_loading": true
    },
    "actor": {
        "group_name": "ActorGroup",
        "training_backend": "fsdp",
        "mcore_gpt": true,
        "spec_name": "decoder_gpt",
        "enable_offload": true,
        "checkpoint_load_path": null,
        "global_batch_size": 512,
        "micro_batch_size": 1,
        "enable_dp_load_balance": false,
        "calculate_flops": false,
        "seed": 1234,
        "model": {
            "precision": "bf16",
            "sharding_strategy": "full_shard",
            "is_lora": false,
            "seq_length": 28672,
            "encoder_seq_length": 28672,
            "model_path": "/home/weight/DeepSeek-R1-Distill-Qwen-1.5B-2layer/"
        },
        "optim": {
            "optimizer": "adam",
            "bf16": true,
            "fp16": false,
            "lr": 2e-05,
            "adam_beta1": 0.9,
            "adam_beta2": 0.95,
            "adam_eps": 1e-05,
            "min_lr": 2e-06,
            "weight_decay": 0.05,
            "use_distributed_optimizer": true,
            "overlap_grad_reduce": false,
            "overlap_param_gather": false,
            "optimizer_enable_pin": false,
            "overlap_param_gather_with_optimizer_step": false,
            "clip_grad": 0.8,
            "loss_scale": 65536
        },
        "lr_sched": {
            "lr_warmup_fraction": 0.01,
            "lr_warmup_init": 0.0,
            "lr_warmup_iters": 0,
            "max_lr": 2e-05,
            "min_lr": 0.0,
            "lr_decay_style": "constant",
            "lr_decay_iters": 10
        },
        "tokenizer": {
            "tokenizer_model": "/home/weight/DeepSeek-R1-Distill-Qwen-1.5B-2layer/",
            "use_fast": false,
            "trust_remote_code": true,
            "padding_side": "right"
        },
        "fsdp": {
            "forward_prefetch": true,
            "limit_all_gathers": true,
            "backward_prefetch": true,
            "use_orig_params": true
        }
    },
    "reward": {
        "group_name": "RewardGroup",
        "use_reward_model": false,
        "reward_type": "math",
        "reward_scale": 5.0,
        "reward_weights": {
            "qa_accuracy": 1.0,
            "think_format": 0.0,
            "answer_format": 0.0
        },
        "tokenizer": {
            "tokenizer_model": "/home/weight/DeepSeek-R1-Distill-Qwen-1.5B-2layer/",
            "use_fast": false,
            "trust_remote_code": true,
            "padding_side": "right"
        }
    },
    "critic": {
        "use_critic_model": false
    }
}